<script>
const consoles = document.querySelectorAll('.console');
let currentIndex = 0;

function showConsole(index) {
    consoles.forEach((c,i)=>c.classList.toggle('active', i===index));
}

// Scroll / wheel navigation
let scrollTimeout;
window.addEventListener('wheel', e=>{
    if(scrollTimeout) return;
    if(e.deltaY>0 && currentIndex<consoles.length-1) currentIndex++;
    else if(e.deltaY<0 && currentIndex>0) currentIndex--;
    showConsole(currentIndex);
    scrollTimeout = setTimeout(()=>scrollTimeout=null, 300);
});

// Arrow keys
window.addEventListener('keydown', e=>{
    if(e.key=="ArrowDown"||e.key=="ArrowRight"){if(currentIndex<consoles.length-1) currentIndex++;}
    else if(e.key=="ArrowUp"||e.key=="ArrowLeft"){if(currentIndex>0) currentIndex--;}
    else{return;}
    showConsole(currentIndex);
});

// Touch navigation (mobile)
let touchStartY = 0;
let touchEndY = 0;
const swipeThreshold = 50; // minimum distance for swipe

window.addEventListener('touchstart', e => {
    touchStartY = e.changedTouches[0].screenY;
});

window.addEventListener('touchend', e => {
    touchEndY = e.changedTouches[0].screenY;
    const diff = touchStartY - touchEndY;
    if(Math.abs(diff) > swipeThreshold){
        if(diff > 0 && currentIndex < consoles.length-1) currentIndex++; // swipe up
        else if(diff < 0 && currentIndex > 0) currentIndex--; // swipe down
        showConsole(currentIndex);
    }
});

// Dark/light toggle
const toggle = document.getElementById('mode-toggle');
toggle.addEventListener('change', ()=>{
    if(toggle.checked){
        document.body.classList.remove('dark'); document.body.classList.add('light');
        document.querySelectorAll('.header').forEach(h=>h.classList.replace('dark','light'));
    } else {
        document.body.classList.remove('light'); document.body.classList.add('dark');
        document.querySelectorAll('.header').forEach(h=>h.classList.replace('light','dark'));
    }
});

// OS detection
const isMac = /Mac|iPhone|iPad|iPod/i.test(navigator.userAgent);
consoles.forEach(c=>{
    const h = c.querySelector('.header');
    if(isMac){
        h.className='mac-header dark';
        h.innerHTML = '<div class="dot red"></div><div class="dot yellow"></div><div class="dot green"></div><span class="title">'+h.querySelector('.title').textContent+'</span>';
    } else {
        h.className='win-header dark';
        h.innerHTML = '<span class="win-title">'+h.querySelector('.title').textContent+'</span><div class="win-buttons"><button title="Minimize">_</button><button title="Maximize">‚òê</button><button title="Close">X</button></div>';
    }
});

// Initialize first console
showConsole(0);
</script>
